<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"//><style>p{margin-top:0pt;margin-bottom:1pt;}p.X1{text-align:justify;}span.X1{font-family:'Calibri';font-size:10.0pt;}</style></head><body><div style="width:595.3pt;margin-bottom:72.0pt;margin-top:72.0pt;margin-left:90.0pt;margin-right:90.0pt;"><p>package com.wesing.doc.service.impl;</p><p><br/></p><p>import java.io.File;</p><p>import java.io.FileInputStream;</p><p>import java.io.FileOutputStream;</p><p>import java.io.IOException;</p><p><br/></p><p>import org.junit.After;</p><p>import org.junit.AfterClass;</p><p>import org.junit.Before;</p><p>import org.junit.BeforeClass;</p><p>import org.junit.Test;</p><p><br/></p><p>import com.wesing.doc.entity.Doc2HtmlOption;</p><p><br/></p><p>public class Doc2HtmlServiceImplTest {</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@BeforeClass</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public static void setUpBeforeClass() throws Exception {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(&quot;===before class===&quot;);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@AfterClass</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public static void tearDownAfterClass() throws Exception {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(&quot;===after class===&quot;);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Before</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void setUp() throws Exception {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(&quot;==before==&quot;);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@After</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void tearDown() throws Exception {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(&quot;==after==&quot;);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//测试Test-00.docx 文件</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Test</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void testDoc2HtmlFileStringDoc2HtmlOption() throws IOException{</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File directory = new File(&quot;&quot;);// 参数为空</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String prjDir = directory.getCanonicalPath();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlServiceImpl doc2HtmlServiceImpl = new Doc2HtmlServiceImpl();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlOption doc2HtmlOption = Doc2HtmlOption.create();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String url2 = Doc2HtmlServiceImplTest.class.getResource(&quot;/&quot;).getFile();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String docFilePath = url2 + &quot;testdoc/&quot; +&quot;Test-00.docx&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File file = new File(docFilePath);</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String htmlFilePath = prjDir +&quot;/html/Test-01.html&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(htmlFilePath);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(docFilePath);</p><p><br/></p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>doc2HtmlServiceImpl.Doc2Html(file, htmlFilePath, doc2HtmlOption);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//测试Text-04.docx文件</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Test</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void testDoc2HtmlFileStringDoc2HtmlOption2() throws IOException{</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File directory = new File(&quot;&quot;);// 参数为空</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String prjDir = directory.getCanonicalPath();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlServiceImpl doc2HtmlServiceImpl = new Doc2HtmlServiceImpl();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlOption doc2HtmlOption = Doc2HtmlOption.create();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String url2 = Doc2HtmlServiceImplTest.class.getResource(&quot;/&quot;).getFile();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String docFilePath = url2 + &quot;testdoc/&quot; +&quot;Text-04.docx&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File file = new File(docFilePath);</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String htmlFilePath = prjDir +&quot;/html/Text-02.html&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(htmlFilePath);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(docFilePath);</p><p><br/></p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>doc2HtmlServiceImpl.Doc2Html(file, htmlFilePath, doc2HtmlOption);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//测试Test-00.docx文件</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Test</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void testDoc2HtmlStringStringDoc2HtmlOption() throws IOException {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File directory = new File(&quot;&quot;);// 参数为空</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String prjDir = directory.getCanonicalPath();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlServiceImpl doc2HtmlServiceImpl = new Doc2HtmlServiceImpl();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlOption doc2HtmlOption = Doc2HtmlOption.create();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String url2 = Doc2HtmlServiceImplTest.class.getResource(&quot;/&quot;).getFile();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String docFilePath = url2 + &quot;testdoc/&quot; +&quot;Test-00.docx&quot;;</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String htmlFilePath = prjDir +&quot;/html/Test-00.html&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(htmlFilePath);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(docFilePath);</p><p><br/></p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>doc2HtmlServiceImpl.Doc2Html(docFilePath, htmlFilePath, doc2HtmlOption);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//测试Text-04.docx文件</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Test</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void testDoc2HtmlStringStringDoc2HtmlOption2() throws IOException {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File directory = new File(&quot;&quot;);// 参数为空</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String prjDir = directory.getCanonicalPath();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlServiceImpl doc2HtmlServiceImpl = new Doc2HtmlServiceImpl();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlOption doc2HtmlOption = Doc2HtmlOption.create();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String url2 = Doc2HtmlServiceImplTest.class.getResource(&quot;/&quot;).getFile();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String docFilePath = url2 + &quot;testdoc/&quot; +&quot;Text-04.docx&quot;;</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String htmlFilePath = prjDir +&quot;/html/Text-04.html&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(htmlFilePath);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(docFilePath);</p><p><br/></p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>doc2HtmlServiceImpl.Doc2Html(docFilePath, htmlFilePath, doc2HtmlOption);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//测试Test-00.docx文件</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Test</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void testDoc2HtmlByteArrayInputStreamDoc2HtmlOption() throws IOException{</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File directory = new File(&quot;&quot;);// 参数为空</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String prjDir = directory.getCanonicalPath();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlServiceImpl doc2HtmlServiceImpl = new Doc2HtmlServiceImpl();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlOption doc2HtmlOption = Doc2HtmlOption.create();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String url2 = Doc2HtmlServiceImplTest.class.getResource(&quot;/&quot;).getFile();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String docFilePath = url2 + &quot;testdoc/&quot; +&quot;Test-00.docx&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String htmlFilePath = prjDir +&quot;/html/Test-05.html&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileInputStream fileInputStream = new FileInputStream(new File(docFilePath));</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileOutputStream fileOutputStream = new FileOutputStream(new File(htmlFilePath));</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(htmlFilePath);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(docFilePath);</p><p><br/></p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>doc2HtmlServiceImpl.Doc2Html(fileInputStream, fileOutputStream, doc2HtmlOption);</p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//测试Text-04.docx文件</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>@Test</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>public void testDoc2HtmlByteArrayInputStreamDoc2HtmlOption2() throws IOException{</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>File directory = new File(&quot;&quot;);// 参数为空</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String prjDir = directory.getCanonicalPath();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlServiceImpl doc2HtmlServiceImpl = new Doc2HtmlServiceImpl();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>Doc2HtmlOption doc2HtmlOption = Doc2HtmlOption.create();</p><p><br/></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String url2 = Doc2HtmlServiceImplTest.class.getResource(&quot;/&quot;).getFile();</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String docFilePath = url2 + &quot;testdoc/&quot; +&quot;Text-04.docx&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>String htmlFilePath = prjDir +&quot;/html/Text-06.html&quot;;</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileInputStream fileInputStream = new FileInputStream(new File(docFilePath));</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileOutputStream fileOutputStream = new FileOutputStream(new File(htmlFilePath));</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(htmlFilePath);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>System.out.println(docFilePath);</p><p><br/></p><p> <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>doc2HtmlServiceImpl.Doc2Html(fileInputStream, fileOutputStream, doc2HtmlOption);</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p>}package com.wesing.doc.service.impl;</p><p><br/></p><p>import java.io.ByteArrayOutputStream;</p><p>import java.io.File;</p><p>import java.io.FileInputStream;</p><p>import java.io.FileNotFoundException;</p><p>import java.io.FileOutputStream;</p><p>import java.io.IOException;</p><p>import java.io.InputStream;</p><p>import java.io.OutputStream;</p><p>import java.io.OutputStreamWriter;</p><p><br/></p><p>import org.apache.poi.xwpf.usermodel.XWPFDocument;</p><p><br/></p><p>import com.wesing.doc.entity.Doc2HtmlOption;</p><p>import com.wesing.doc.service.Doc2HtmlService;</p><p>import com.wesing.doc.util.FileUtil;</p><p><br/></p><p>import fr.opensagres.poi.xwpf.converter.core.ImageManager;</p><p>import fr.opensagres.poi.xwpf.converter.core.XWPFConverterException;</p><p>import fr.opensagres.poi.xwpf.converter.xhtml.Base64EmbedImgManager;</p><p>import fr.opensagres.poi.xwpf.converter.xhtml.XHTMLConverter;</p><p>import fr.opensagres.poi.xwpf.converter.xhtml.XHTMLOptions;</p><p><br/></p><p>/**</p><p> * doc文件转换类</p><p> */</p><p>public class Doc2HtmlServiceImpl implements Doc2HtmlService {</p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>    @Override</p><p>    public boolean Doc2Html(File docFile, String htmlFilePath, Doc2HtmlOption option) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>try {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XWPFDocument xwpfDocument = new XWPFDocument(new FileInputStream(docFile));</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XHTMLOptions options = XHTMLOptions.create();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//以Base64的方式将图片写入Html页面</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>ImageManager imageManager = new Base64EmbedImgManager();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setImageManager(imageManager);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//配置信息</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setFragment(option.isFragment());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setIgnoreStylesIfUnused(option.isIgnoreStylesIfUnused());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setOmitHeaderFooterPages(option.isOmitHeaderFooterPages());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//选择文件输出位置,htmlFilePath为目标目录</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>OutputStreamWriter outputStreamWriter = new OutputStreamWriter(new FileOutputStream(htmlFilePath), &quot;utf-8&quot;);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XHTMLConverter xHtmlConverter = (XHTMLConverter)XHTMLConverter.getInstance();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//执行转换</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>xHtmlConverter.convert(xwpfDocument, outputStreamWriter, options);</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch (IOException ioException) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>ioException.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch (Exception e) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>e.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p>        return true;</p><p>    </p><p>    }</p><p><br/></p><p>    @Override</p><p>    public boolean Doc2Html(String docFilePath, String htmlFilePath, Doc2HtmlOption option) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>try {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileInputStream docfileInputStream = new FileInputStream(docFilePath);</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XWPFDocument xwpfDocument = new XWPFDocument(docfileInputStream);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XHTMLOptions options = XHTMLOptions.create();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//以Base64的方式将图片写入Html页面</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>ImageManager imageManager = new Base64EmbedImgManager();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setImageManager(imageManager);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//配置信息</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setFragment(option.isFragment());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setIgnoreStylesIfUnused(option.isIgnoreStylesIfUnused());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setOmitHeaderFooterPages(option.isOmitHeaderFooterPages());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//选择文件输出位置,htmlFilePath为目标目录</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileOutputStream fileOutputStream = new FileOutputStream(htmlFilePath);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>OutputStreamWriter outputStreamWriter = new OutputStreamWriter(fileOutputStream, &quot;utf-8&quot;);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XHTMLConverter xHtmlConverter = (XHTMLConverter)XHTMLConverter.getInstance();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//执行转换</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>xHtmlConverter.convert(xwpfDocument, outputStreamWriter, options);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//characterSet</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>FileUtil.addCharacterSet(htmlFilePath);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch(FileNotFoundException fileNotFoundException) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>fileNotFoundException.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch(XWPFConverterException xwpfConverterException) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>xwpfConverterException.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch(IOException ioException) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>ioException.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        return true;</p><p>    }</p><p><br/></p><p>    @Override</p><p>    public ByteArrayOutputStream Doc2Html(InputStream inputStream, OutputStream outputStream, Doc2HtmlOption option) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>try {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XWPFDocument xwpfDocument = new XWPFDocument(inputStream);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XHTMLOptions options = XHTMLOptions.create();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//以Base64的方式将图片写入Html页面</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>ImageManager imageManager = new Base64EmbedImgManager();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setImageManager(imageManager);</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//配置信息</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setFragment(option.isFragment());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setIgnoreStylesIfUnused(option.isIgnoreStylesIfUnused());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>options.setOmitHeaderFooterPages(option.isOmitHeaderFooterPages());</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>XHTMLConverter xHtmlConverter = (XHTMLConverter)XHTMLConverter.getInstance();</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>//执行转换</p><p>        <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>xHtmlConverter.convert(xwpfDocument, outputStream, options);</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch (IOException ioException) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>ioException.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}catch (Exception e) {</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>e.printStackTrace();</p><p>    <span>&nbsp;&nbsp;&nbsp;&nbsp;</span>}</p><p>        return null;</p><p>    }</p><p>}</p><p/></div></body></html>